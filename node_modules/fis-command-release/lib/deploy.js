/*
 * fis
 * http://web.baidu.com/
 */

'use strict';

var lastModified = {};

function deploy(file){
    console.log('deploy [' + file.realpath + ']');
}

module.exports = function(dest, ret, fis){
    fis.util.map(ret.src, function(subpath, file){
        var changed = file.cache && file.cache.expired;
        if(!changed){
            var mtime = file.getMtime().getTime();
            if(lastModified[file.realpath] != mtime){
                changed = true;
                lastModified[file.realpath] = mtime;
            }
        }
        if(changed){
            deploy(file);
        }
    });
    fis.util.map(ret.pkg, function(subpath, file){
        deploy(file);
    });
};